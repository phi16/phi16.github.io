<!DOCTYPE html>
<html>
  <head>
    <style>
      textarea { width: 800px; height: 200px; }
    </style>
  </head>
  <body>
    <textarea id="cont"></textarea>
    <button id="b">Pochi</button>
    <br>
    Result
    <br>
    <textarea readonly id="result"></textarea>
    <br>
    Another Texts
    <br>
    <textarea readonly id="ano"></textarea>
    <script type="text/javascript">

document.getElementById("b").addEventListener("click",_=>{
  const text = document.getElementById("cont").value.split("\n");
  const at = [];
  function co(n, s) {
    const name = { p: "phi", c: "Cap", l: "らくと" };
    const color = { p: "#218300", c: "#a30b47", l: "#08509c" };
    return `<font color="${color[n]}">**${name[n]}:** ${s}</font>`;
  }
  for(let i=0;i<text.length;i++) {
    const t = text[i];
    if(t.substr(0,3) == "p: ") text[i] = co("p", t.substr(3));
    else if(t.substr(0,3) == "c: ") text[i] = co("c", t.substr(3));
    else if(t.substr(0,3) == "l: ") text[i] = co("l", t.substr(3));
    else if(t.length != 0) at.push(t);
  }
  document.getElementById("result").value = text.join("\n");
  document.getElementById("ano").value = at.join("\n");
});

    </script>
  </body>
</html>
